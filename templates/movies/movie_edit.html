{% extends 'base.html' %}

{% block content %}
	<div class="row justify-content-center">
		<div class="col-md-8">
			<h1>Edit Movie</h1>

			{% if form.non_field_errors %}
				<div class="alert alert-danger">
					{% for error in form.non_field_errors %}
						<p>{{ error }}</p>
					{% endfor %}
				</div>
			{% endif %}

			<form method="post" enctype="multipart/form-data">
				{% csrf_token %}

				<div class="mb-3">
					<label for="{{ form.title.id_for_label }}" class="form-label">{{ form.title.label }}</label>
					{{ form.title }}
					{% if form.title.errors %}
						<div class="alert alert-danger small mt-1">
							{% for error in form.title.errors %}
								<p>{{ error }}</p>
							{% endfor %}
						</div>
					{% endif %}
				</div>

				<div class="mb-3">
					<label for="{{ form.description.id_for_label }}" class="form-label">{{ form.description.label }}</label>
					{{ form.description }}
					{% if form.description.errors %}
						<div class="alert alert-danger small mt-1">
							{% for error in form.description.errors %}
								<p>{{ error }}</p>
							{% endfor %}
						</div>
					{% endif %}
				</div>

				<div class="row">
					<div class="col-md-6 mb-3">
						<label for="{{ form.release_date.id_for_label }}" class="form-label">{{ form.release_date.label }}</label>
						{{ form.release_date }}
						{% if form.release_date.errors %}
							<div class="alert alert-danger small mt-1">
								{% for error in form.release_date.errors %}
									<p>{{ error }}</p>
								{% endfor %}
							</div>
						{% endif %}
					</div>

					<div class="col-md-6 mb-3">
						<label for="{{ form.rating.id_for_label }}" class="form-label">{{ form.rating.label }}</label>
						{{ form.rating }}
						{% if form.rating.errors %}
							<div class="alert alert-danger small mt-1">
								{% for error in form.rating.errors %}
									<p>{{ error }}</p>
								{% endfor %}
							</div>
						{% endif %}
					</div>
				</div>

				<div class="row">
					<div class="col-md-6 mb-3">
						<label for="{{ form.category.id_for_label }}" class="form-label">{{ form.category.label }}</label>
						{{ form.category }}
						{% if form.category.errors %}
							<div class="alert alert-danger small mt-1">
								{% for error in form.category.errors %}
									<p>{{ error }}</p>
								{% endfor %}
							</div>
						{% endif %}
					</div>

					<div class="col-md-6 mb-3">
						<label class="form-label">{{ form.genres.label }}</label>
						<div class="border p-2 rounded" style="max-height: 200px; overflow-y: auto;">
							{{ form.genres }}
						</div>
						{% if form.genres.errors %}
							<div class="alert alert-danger small mt-1">
								{% for error in form.genres.errors %}
									<p>{{ error }}</p>
								{% endfor %}
							</div>
						{% endif %}
					</div>
				</div>

				<div class="mb-3">
					<label for="{{ form.poster.id_for_label }}" class="form-label">{{ form.poster.label }}</label>
					{% if movie.poster %}
						<div class="mb-2">
							<img src="{{ movie.poster.url }}" style="max-width: 200px;" class="rounded">
							<p class="text-muted small">Current poster</p>
						</div>
					{% endif %}
					{{ form.poster }}
					{% if form.poster.errors %}
						<div class="alert alert-danger small mt-1">
							{% for error in form.poster.errors %}
								<p>{{ error }}</p>
							{% endfor %}
						</div>
					{% endif %}
				</div>

				<div class="d-flex gap-2">
					<button type="submit" class="btn btn-primary">Save Changes</button>
					<a href="{% url 'movies:detail' movie.pk %}" class="btn btn-outline-secondary">Cancel</a>
				</div>
			</form>
		</div>
	</div>
{% endblock %}
